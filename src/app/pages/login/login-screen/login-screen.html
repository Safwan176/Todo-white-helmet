<main class="login-container" role="main">
  <!-- Background Animation -->
  <div class="background-animation">
    <div class="floating-shape shape-1"></div>
    <div class="floating-shape shape-2"></div>
    <div class="floating-shape shape-3"></div>
  </div>

  <!-- Login Card -->
  <div class="login-card card-elevated">
    <!-- Welcome Header -->
    <header class="login-header">
      <div class="brand-logo">
        <div class="logo-icon">
          <i class="fas fa-tasks" aria-hidden="true"></i>
        </div>
        <h1 class="brand-title">TodoApp</h1>
      </div>
      <div class="welcome-content">
        <h2 class="welcome-title">Welcome back!</h2>
        <p class="welcome-subtitle">Sign in to continue organizing your life</p>
      </div>
    </header>

    <!-- Login Form -->
    <section class="login-form-section" aria-labelledby="form-heading">
      <h3 id="form-heading" class="sr-only">Login Form</h3>
      
      <form [formGroup]="loginForm" (ngSubmit)="onLogin()" class="login-form" novalidate>
        
        <!-- Username/Email Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Username or Email</mat-label>
            <input 
              matInput 
              type="text" 
              formControlName="username"
              placeholder="Enter your username or email"
              autocomplete="username"
              [attr.aria-describedby]="loginForm.get('username')?.hasError('required') ? 'username-error' : null">
            <mat-icon matPrefix class="field-icon">person</mat-icon>

            <!-- Username Validation Errors -->
            @if (loginForm.get('username')?.hasError('required') && loginForm.get('username')?.touched) {
              <mat-error id="username-error" role="alert">Username or email is required</mat-error>
            } @else if (loginForm.get('username')?.hasError('email') && loginForm.get('username')?.touched) {
              <mat-error id="username-error" role="alert">Please enter a valid email address</mat-error>
            }
          </mat-form-field>
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Password</mat-label>
            <input 
              matInput 
              [type]="hidePassword ? 'password' : 'text'" 
              formControlName="password"
              placeholder="Enter your password"
              autocomplete="current-password"
              [attr.aria-describedby]="loginForm.get('password')?.hasError('required') ? 'password-error' : null">
            <mat-icon matPrefix class="field-icon">lock</mat-icon>
            
            <!-- Password Toggle Button -->
            <button 
              mat-icon-button 
              matSuffix 
              type="button"
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="hidePassword ? 'Show password' : 'Hide password'"
              [attr.aria-pressed]="!hidePassword"
              class="password-toggle">
              <mat-icon>{{hidePassword ? 'visibility' : 'visibility_off'}}</mat-icon>
            </button>
            
            <!-- Password Validation Errors -->
            @if (loginForm.get('password')?.hasError('required') && loginForm.get('password')?.touched) {
              <mat-error id="password-error" role="alert">Password is required</mat-error>
            } @else if (loginForm.get('password')?.hasError('minlength') && loginForm.get('password')?.touched) {
              <mat-error id="password-error" role="alert">Password must be at least 6 characters long</mat-error>
            }
          </mat-form-field>
        </div>

        <!-- Error Message Display -->
        @if (errorMessage) {
          <div class="error-alert" role="alert" aria-live="polite">
            <mat-icon>error_outline</mat-icon>
            <span>{{ errorMessage }}</span>
          </div>
        }

        <!-- Login Button -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn btn-primary btn-lg login-btn"
            [disabled]="loginForm.invalid || isLoading"
            [attr.aria-describedby]="loginForm.invalid ? 'login-button-help' : null">
            
            @if (isLoading) {
              <mat-spinner diameter="20" class="btn-spinner"></mat-spinner>
              <span>Signing in...</span>
            } @else {
              <mat-icon>login</mat-icon>
              <span>Sign In</span>
            }
          </button>
          
          @if (loginForm.invalid) {
            <p id="login-button-help" class="form-help">Please fill in all required fields to continue</p>
          }
        </div>

      </form>
    </section>


  </div>

  <!-- Version Info -->
  <div class="version-info">
    <p>&copy; 2025 TodoApp v1.0.0</p>
  </div>
</main>
